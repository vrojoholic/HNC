<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI H&C East Power Reply Email Solution</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        @font-face {
            font-family: 'HarryPotter';
            src: url('https://fonts.cdnfonts.com/s/7289/Hogwarts-Wizard.woff') format('woff');
        }

        body {
            font-family: 'Inter', sans-serif;
            transition: background-image 1s ease-in-out;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #333;
        }

        .bg-acmilan {
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('1618363661269.jpeg');
        }
        .text-acmilan {
            color: #E20021;
        }

        .bg-liverpool {
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('499267819_18506217601053893_7515771928710394199_n.jpg');
        }
        .text-liverpool {
            color: #C8102E;
        }

        .title-font {
            font-family: 'HarryPotter', sans-serif;
            letter-spacing: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .card {
            backdrop-filter: blur(15px) brightness(1.1);
            background-color: rgba(255, 255, 255, 0.75);
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Custom scrollbar */
        textarea::-webkit-scrollbar {
            width: 8px;
        }

        textarea::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 10px;
        }

        textarea::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            border: 2px solid transparent;
            background-clip: padding-box;
        }

        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="bg-acmilan flex items-center justify-center min-h-screen p-4">

    <div id="app-container" class="w-full max-w-2xl mx-auto my-auto p-8 rounded-2xl shadow-lg card relative">
        <div class="absolute top-4 right-4">
            <select id="languageSelect" class="bg-transparent border-none text-gray-800 font-semibold p-2 rounded-xl focus:outline-none">
                <option value="indonesian">ID</option>
                <option value="english">EN</option>
            </select>
        </div>
        <div class="flex flex-col items-center">
            <svg id="logo" class="w-24 h-24 mb-4" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Outer circle -->
                <circle cx="50" cy="50" r="45" fill="#E20021" stroke="#1F2937" stroke-width="5"/>
                
                <!-- H letter -->
                <path d="M25 40 L25 60 M25 50 L45 50 M45 40 L45 60" stroke="#1F2937" stroke-width="5" stroke-linecap="round"/>
                
                <!-- & symbol -->
                <path d="M55 45 Q 60 40, 65 45 Q 70 50, 65 55 Q 60 60, 55 55" stroke="#1F2937" stroke-width="5" stroke-linecap="round"/>
                
                <!-- C letter -->
                <path d="M75 60 C 85 50, 85 40, 75 40" stroke="#1F2937" stroke-width="5" stroke-linecap="round"/>
            </svg>

            <h1 class="text-5xl font-extrabold text-center text-gray-900 leading-tight title-font">H&C East Power</h1>
            <p id="appSubtitle" class="mt-2 text-xl font-medium text-center text-gray-700">Reply Email Solution with AI Model</p>
        </div>

        <div class="mt-8 space-y-5">
            <div>
                <label id="subjectLabel" for="emailSubject" class="block text-sm font-semibold text-gray-800">Subjek Email</label>
                <input type="text" id="emailSubject" class="mt-2 block w-full rounded-xl border-2 border-gray-300 shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300" placeholder="Contoh: Permintaan Penawaran, Pertanyaan Produk">
            </div>
            <div>
                <label id="toLabel" for="emailTo" class="block text-sm font-semibold text-gray-800">Tujuan Email</label>
                <input type="text" id="emailTo" class="mt-2 block w-full rounded-xl border-2 border-gray-300 shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300" placeholder="Kepada siapa email ini ditujukan? (Contoh: Bapak/Ibu Yth.)">
            </div>
            <div>
                <label id="contentLabel" for="emailContent" class="block text-sm font-semibold text-gray-800">Konten Email</label>
                <textarea id="emailContent" rows="8" class="mt-2 block w-full rounded-xl border-2 border-gray-300 shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500 transition-all duration-300" placeholder="Tempelkan email yang diterima di sini untuk dianalisis AI..."></textarea>
            </div>
        </div>

        <div class="mt-8 flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4">
            <button id="generateBtn" class="flex-1 w-full px-6 py-4 border border-transparent text-base font-semibold rounded-full shadow-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-300">
                <span id="buttonText">Generate Balasan</span>
                <div id="loadingIndicator" class="hidden flex items-center justify-center">
                    <svg class="animate-spin h-5 w-5 text-white mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Generating...
                </div>
            </button>
            <button id="copyBtn" class="flex-1 w-full px-6 py-4 border border-transparent text-base font-semibold rounded-full shadow-lg text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-300">
                Salin Balasan
            </button>
        </div>
        
        <div id="messageBox" class="mt-6 hidden p-4 rounded-xl text-sm text-white text-center font-medium"></div>

        <div id="outputContainer" class="mt-8 hidden">
            <label id="replyLabel" for="generatedReply" class="block text-sm font-semibold text-gray-800">Balasan Email yang Dihasilkan</label>
            <textarea id="generatedReply" rows="8" class="mt-2 block w-full rounded-xl border-2 border-gray-300 bg-gray-100 shadow-inner p-3 transition-all duration-300" readonly></textarea>
        </div>

    </div>

    <script>
        const generateBtn = document.getElementById('generateBtn');
        const copyBtn = document.getElementById('copyBtn');
        const languageSelect = document.getElementById('languageSelect');
        const emailSubjectInput = document.getElementById('emailSubject');
        const emailToInput = document.getElementById('emailTo');
        const emailContentTextarea = document.getElementById('emailContent');
        const generatedReplyTextarea = document.getElementById('generatedReply');
        const outputContainer = document.getElementById('outputContainer');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const buttonText = document.getElementById('buttonText');
        const messageBox = document.getElementById('messageBox');
        const bodyElement = document.body;
        const logoElement = document.getElementById('logo');

        let isHarjara = true;
        let isMilan = true;

        const translations = {
            indonesian: {
                appSubtitle: 'Reply Email Solution with AI Model',
                subjectLabel: 'Subjek Email',
                subjectPlaceholder: 'Contoh: Permintaan Penawaran, Pertanyaan Produk',
                toLabel: 'Tujuan Email',
                toPlaceholder: 'Kepada siapa email ini ditujukan? (Contoh: Bapak/Ibu Yth.)',
                contentLabel: 'Konten Email',
                contentPlaceholder: 'Tempelkan email yang diterima di sini untuk dianalisis AI...',
                generateButton: 'Generate Balasan',
                copyButton: 'Salin Balasan',
                replyLabel: 'Balasan Email yang Dihasilkan',
                loading: 'Generating...',
                messageSuccess: 'Balasan email berhasil dibuat!',
                messageCopied: 'Balasan disalin ke clipboard!',
                messageEmpty: 'Tidak ada balasan untuk disalin.',
                messageError: 'Harap isi semua bidang: Subjek Email, Tujuan, dan Konten.',
                messageApiError: 'Gagal menghasilkan balasan. Mohon coba lagi.',
                messageServerError: 'Terjadi kesalahan saat menghubungi server. Mohon coba lagi.'
            },
            english: {
                appSubtitle: 'AI Model Email Reply Solution',
                subjectLabel: 'Email Subject',
                subjectPlaceholder: 'Example: Quote Request, Product Inquiry',
                toLabel: 'Recipient',
                toPlaceholder: 'Who is this email for? (e.g., Dear Mr./Ms.)',
                contentLabel: 'Email Content',
                contentPlaceholder: 'Paste the received email here for AI analysis...',
                generateButton: 'Generate Reply',
                copyButton: 'Copy Reply',
                replyLabel: 'Generated Email Reply',
                loading: 'Generating...',
                messageSuccess: 'Email reply generated successfully!',
                messageCopied: 'Reply copied to clipboard!',
                messageEmpty: 'No reply to copy.',
                messageError: 'Please fill in all fields: Subject, Recipient, and Content.',
                messageApiError: 'Failed to generate a reply. Please try again.',
                messageServerError: 'An error occurred while contacting the server. Please try again.'
            }
        };

        // Function to update UI text based on language
        function updateUI(lang) {
            const t = translations[lang];
            document.getElementById('appSubtitle').textContent = t.appSubtitle;
            document.getElementById('subjectLabel').textContent = t.subjectLabel;
            emailSubjectInput.placeholder = t.subjectPlaceholder;
            document.getElementById('toLabel').textContent = t.toLabel;
            emailToInput.placeholder = t.toPlaceholder;
            document.getElementById('contentLabel').textContent = t.contentLabel;
            emailContentTextarea.placeholder = t.contentPlaceholder;
            document.getElementById('buttonText').textContent = t.generateButton;
            document.getElementById('copyBtn').textContent = t.copyButton;
            document.getElementById('replyLabel').textContent = t.replyLabel;
        }

        // Initial UI update
        updateUI(languageSelect.value);

        // Language change event
        languageSelect.addEventListener('change', (e) => {
            updateUI(e.target.value);
        });

        // Function to show a temporary message
        function showMessage(textKey, isError = false) {
            const lang = languageSelect.value;
            messageBox.textContent = translations[lang][textKey];
            messageBox.className = `mt-6 block p-4 rounded-xl text-sm text-white text-center font-medium ${isError ? 'bg-red-500' : 'bg-green-500'}`;
            messageBox.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.add('hidden');
            }, 3000);
        }

        // Function to handle image and color rotation
        function rotateBackgroundAndLogo() {
            // Rotate background image
            if (isHarjara) {
                bodyElement.classList.remove('bg-acmilan');
                bodyElement.classList.add('bg-liverpool');
                isHarjara = false;
            } else {
                bodyElement.classList.remove('bg-liverpool');
                bodyElement.classList.add('bg-acmilan');
                isHarjara = true;
            }

            // Change logo colors
            const logoPaths = logoElement.querySelectorAll('path, circle');
            if (isMilan) {
                logoPaths.forEach(path => {
                    if (path.tagName === 'circle') {
                        path.setAttribute('fill', '#C8102E'); // Liverpool red
                    }
                    path.setAttribute('stroke', '#FFF'); // Liverpool white
                });
                isMilan = false;
            } else {
                logoPaths.forEach(path => {
                    if (path.tagName === 'circle') {
                        path.setAttribute('fill', '#E20021'); // AC Milan red
                    }
                    path.setAttribute('stroke', '#1F2937'); // AC Milan black
                });
                isMilan = true;
            }
        }

        // Generate button click event
        generateBtn.addEventListener('click', async () => {
            const subject = emailSubjectInput.value;
            const to = emailToInput.value;
            const content = emailContentTextarea.value;
            const language = languageSelect.value;

            if (!subject || !to || !content) {
                showMessage('messageError', true);
                return;
            }
            
            buttonText.classList.add('hidden');
            loadingIndicator.classList.remove('hidden');
            generateBtn.disabled = true;

            let prompt;
            if (language === 'english') {
                prompt = `Please provide a very polite, professional, and elegant email reply in English.
Email subject: ${subject}
Email recipient: ${to}
Email content: ${content}`;
            } else {
                prompt = `Berikan balasan email yang sangat sopan, profesional, dan elegan dalam Bahasa Indonesia.
Subjek email: ${subject}
Tujuan email: ${to}
Isi email: ${content}`;
            }

            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            let retryCount = 0;
            const maxRetries = 3;
            const delay = 1000;

            const makeApiCall = async () => {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const generatedText = result?.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (generatedText) {
                        generatedReplyTextarea.value = generatedText;
                        outputContainer.classList.remove('hidden');
                        showMessage('messageSuccess');
                        rotateBackgroundAndLogo();
                    } else {
                        showMessage('messageApiError', true);
                    }
                } catch (error) {
                    console.error('API call failed:', error);
                    if (retryCount < maxRetries) {
                        retryCount++;
                        setTimeout(() => makeApiCall(), delay * Math.pow(2, retryCount));
                    } else {
                        showMessage('messageServerError', true);
                    }
                } finally {
                    loadingIndicator.classList.add('hidden');
                    buttonText.classList.remove('hidden');
                    generateBtn.disabled = false;
                }
            };
            
            makeApiCall();
        });

        // Copy button click event
        copyBtn.addEventListener('click', () => {
            if (generatedReplyTextarea.value) {
                generatedReplyTextarea.select();
                generatedReplyTextarea.setSelectionRange(0, 99999); /* For mobile devices */
                document.execCommand('copy');
                showMessage('messageCopied');
            } else {
                showMessage('messageEmpty', true);
            }
        });
    </script>
</body>
</html>
